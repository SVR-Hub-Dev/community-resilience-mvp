import{a as c,f as p,c as ze}from"../chunks/deXkMWSk.js";import{o as Ce}from"../chunks/BKIXhqgW.js";import{z as Ke,K as _,P as Fe,J as a,B as e,A as g,C as Te,e as Ae,D as i,$ as De,F as s,I as r,M as Be,G as Se,O as $e}from"../chunks/xmsiYLBb.js";import{d as qe,s as m,e as Ie}from"../chunks/BjJ1wdql.js";import{i as h}from"../chunks/Iv35OxqL.js";import{h as Me,a as U,b as A,e as ve,i as oe}from"../chunks/BqvhUv_W.js";import{r as H}from"../chunks/Dye65HWv.js";var Ne=p('<div class="alert alert-error"> </div>'),Re=p('<div class="card form-card svelte-u7nvcr"><h2 class="svelte-u7nvcr"> </h2> <form><div class="form-group svelte-u7nvcr"><label class="label" for="title">Title *</label> <input id="title" class="input" required/></div> <div class="form-group svelte-u7nvcr"><label class="label" for="description">Description *</label> <textarea id="description" class="textarea" required></textarea></div> <div class="form-row svelte-u7nvcr"><div class="form-group svelte-u7nvcr"><label class="label" for="tags">Tags (comma-separated)</label> <input id="tags" class="input" placeholder="flood, evacuation, elderly"/></div> <div class="form-group svelte-u7nvcr"><label class="label" for="hazardType">Hazard Type</label> <input id="hazardType" class="input" placeholder="flood, fire, storm"/></div></div> <div class="form-row svelte-u7nvcr"><div class="form-group svelte-u7nvcr"><label class="label" for="location">Location</label> <input id="location" class="input" placeholder="Riverside Street"/></div> <div class="form-group svelte-u7nvcr"><label class="label" for="source">Source</label> <input id="source" class="input" placeholder="Community workshop 2023"/></div></div> <div class="form-actions svelte-u7nvcr"><button type="button" class="btn btn-secondary">Cancel</button> <button type="submit" class="btn btn-primary"> </button></div></form></div>'),je=p('<div class="loading"><div class="spinner"></div></div>'),Ge=p('<div class="card empty-state svelte-u7nvcr"><p>No knowledge entries yet. Add your first entry to get started.</p></div>'),He=p('<span class="meta-item svelte-u7nvcr"> </span>'),Je=p('<span class="badge badge-warning"> </span>'),Le=p('<span class="badge badge-primary"> </span>'),Oe=p('<div class="entry-tags svelte-u7nvcr"></div>'),Pe=p('<p class="entry-source svelte-u7nvcr"> </p>'),Ue=p('<div class="card entry-card svelte-u7nvcr"><div class="entry-header svelte-u7nvcr"><h3 class="svelte-u7nvcr"> </h3> <div class="entry-actions svelte-u7nvcr"><button class="btn-icon svelte-u7nvcr" title="Edit">‚úèÔ∏è</button> <button class="btn-icon svelte-u7nvcr" title="Delete">üóëÔ∏è</button></div></div> <p class="entry-description svelte-u7nvcr"> </p> <div class="entry-meta svelte-u7nvcr"><!> <!></div> <!> <!></div>'),Qe=p('<div class="entries-grid svelte-u7nvcr"></div>'),Ve=p('<div class="container"><div class="page-header svelte-u7nvcr"><div class="header-row svelte-u7nvcr"><h1 class="svelte-u7nvcr">Knowledge Base</h1> <button class="btn btn-primary"> </button></div> <p class="svelte-u7nvcr">Community knowledge entries used for disaster response recommendations.</p></div> <!> <!> <!></div>');function ra(ne,de){Ke(de,!0);let Q=_(Fe([])),V=_(!0),y=_(""),k=_(!1),z=_(null),D=_(""),B=_(""),S=_(""),$=_(""),q=_(""),I=_("");Ce(async()=>{await W()});async function W(){a(V,!0),a(y,"");try{a(Q,await U.getKnowledge(),!0)}catch(t){a(y,t instanceof Error?t.message:"Failed to load knowledge entries",!0)}finally{a(V,!1)}}function X(){a(D,""),a(B,""),a(S,""),a($,""),a(q,""),a(I,""),a(z,null),a(k,!1)}function ce(t){var l;a(D,t.title,!0),a(B,t.description,!0),a(S,((l=t.tags)==null?void 0:l.join(", "))||"",!0),a($,t.location||"",!0),a(q,t.hazard_type||"",!0),a(I,t.source||"",!0),a(z,t.id,!0),a(k,!0)}async function ue(t){t.preventDefault(),a(y,"");const l={title:e(D),description:e(B),tags:e(S).split(",").map(u=>u.trim()).filter(Boolean),location:e($)||null,hazard_type:e(q)||null,source:e(I)||null};try{e(z)?await U.updateKnowledge(e(z),l):await U.createKnowledge(l),X(),await W()}catch(u){a(y,u instanceof Error?u.message:"Failed to save entry",!0)}}async function pe(t){if(confirm("Are you sure you want to delete this entry?"))try{await U.deleteKnowledge(t),await W()}catch(l){a(y,l instanceof Error?l.message:"Failed to delete entry",!0)}}var Y=Ve();Me("u7nvcr",t=>{Ae(()=>{De.title="Knowledge Base - Community Resilience"})});var Z=s(Y),se=s(Z),ee=i(s(se),2);ee.__click=()=>{X(),a(k,!e(k))};var _e=s(ee,!0);r(ee),r(se),Be(2),r(Z);var ie=i(Z,2);{var fe=t=>{var l=Ne(),u=s(l,!0);r(l),g(()=>m(u,e(y))),c(t,l)};h(ie,t=>{e(y)&&t(fe)})}var le=i(ie,2);{var me=t=>{var l=Re(),u=s(l),ae=s(u,!0);r(u);var M=i(u,2),f=s(M),b=i(s(f),2);H(b),r(f);var N=i(f,2),o=i(s(N),2);Se(o),r(N);var w=i(N,2),x=s(w),C=i(s(x),2);H(C),r(x);var J=i(x,2),R=i(s(J),2);H(R),r(J),r(w);var K=i(w,2),j=s(K),F=i(s(j),2);H(F),r(j);var L=i(j,2),T=i(s(L),2);H(T),r(L),r(K);var G=i(K,2),O=s(G);O.__click=X;var P=i(O,2),te=s(P);r(P),r(G),r(M),r(l),g(()=>{m(ae,e(z)?"Edit Entry":"Add New Entry"),m(te,`${e(z)?"Update":"Create"} Entry`)}),Ie("submit",M,ue),A(b,()=>e(D),d=>a(D,d)),A(o,()=>e(B),d=>a(B,d)),A(C,()=>e(S),d=>a(S,d)),A(R,()=>e(q),d=>a(q,d)),A(F,()=>e($),d=>a($,d)),A(T,()=>e(I),d=>a(I,d)),c(t,l)};h(le,t=>{e(k)&&t(me)})}var be=i(le,2);{var ge=t=>{var l=je();c(t,l)},he=t=>{var l=ze(),u=$e(l);{var ae=f=>{var b=Ge();c(f,b)},M=f=>{var b=Qe();ve(b,21,()=>e(Q),oe,(N,o)=>{var w=Ue(),x=s(w),C=s(x),J=s(C,!0);r(C);var R=i(C,2),K=s(R);K.__click=()=>ce(e(o));var j=i(K,2);j.__click=()=>pe(e(o).id),r(R),r(x);var F=i(x,2),L=s(F,!0);r(F);var T=i(F,2),G=s(T);{var O=n=>{var v=He(),E=s(v);r(v),g(()=>m(E,`üìç ${e(o).location??""}`)),c(n,v)};h(G,n=>{e(o).location&&n(O)})}var P=i(G,2);{var te=n=>{var v=Je(),E=s(v,!0);r(v),g(()=>m(E,e(o).hazard_type)),c(n,v)};h(P,n=>{e(o).hazard_type&&n(te)})}r(T);var d=i(T,2);{var ye=n=>{var v=Oe();ve(v,21,()=>e(o).tags,oe,(E,Ee)=>{var re=Le(),ke=s(re,!0);r(re),g(()=>m(ke,e(Ee))),c(E,re)}),r(v),c(n,v)};h(d,n=>{var v;(v=e(o).tags)!=null&&v.length&&n(ye)})}var we=i(d,2);{var xe=n=>{var v=Pe(),E=s(v);r(v),g(()=>m(E,`Source: ${e(o).source??""}`)),c(n,v)};h(we,n=>{e(o).source&&n(xe)})}r(w),g(()=>{m(J,e(o).title),m(L,e(o).description)}),c(N,w)}),r(b),c(f,b)};h(u,f=>{e(Q).length===0?f(ae):f(M,!1)},!0)}c(t,l)};h(be,t=>{e(V)?t(ge):t(he,!1)})}r(Y),g(()=>m(_e,e(k)?"Cancel":"Add Entry")),c(ne,Y),Te()}qe(["click"]);export{ra as component};
