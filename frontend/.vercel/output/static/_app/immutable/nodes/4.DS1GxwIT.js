import{d as Ae,a as f,f as y,s as _,c as Ke,e as we}from"../chunks/DrEVJf_X.js";import{o as Pe}from"../chunks/CY6dNTIf.js";import{a0 as Ie,a8 as m,ab as Ce,aa as ae,b as l,a2 as De,e as Ne,a3 as i,a5 as Ee,a4 as s,g as t,a7 as a,a1 as D}from"../chunks/BIQOLOFU.js";import{i as w}from"../chunks/NPzolRrf.js";import{e as Le,i as Me}from"../chunks/BPKzcg-U.js";import{h as Se}from"../chunks/82X_sTQh.js";import{r as G}from"../chunks/CDiOZD_h.js";import{s as Fe}from"../chunks/DrIL6A14.js";import{b as H}from"../chunks/COIuQCY0.js";import{g as Re}from"../chunks/D1v8bg46.js";import{a as J,g as Te}from"../chunks/D6zz_Kj-.js";var Ye=y('<div class="error-banner svelte-l2iqfo"> </div>'),Ue=y('<div class="loading svelte-l2iqfo">Loading...</div>'),We=y(`<div class="empty-state svelte-l2iqfo"><p>You don't have any API keys yet.</p> <p>Create one to start using the API programmatically.</p></div>`),je=y('<span class="key-description svelte-l2iqfo"> </span>'),ze=y('<tr><td class="svelte-l2iqfo"><span class="key-name svelte-l2iqfo"> </span> <!></td><td class="svelte-l2iqfo"><code> </code></td><td class="svelte-l2iqfo"> </td><td class="svelte-l2iqfo"> </td><td class="svelte-l2iqfo"><span> </span></td><td class="svelte-l2iqfo"><button class="btn btn-danger btn-sm svelte-l2iqfo">Revoke</button></td></tr>'),Be=y('<table class="table svelte-l2iqfo"><thead><tr><th class="svelte-l2iqfo">Name</th><th class="svelte-l2iqfo">Key Prefix</th><th class="svelte-l2iqfo">Last Used</th><th class="svelte-l2iqfo">Expires</th><th class="svelte-l2iqfo">Status</th><th class="svelte-l2iqfo"></th></tr></thead><tbody></tbody></table>'),Ge=y('<div class="modal-overlay svelte-l2iqfo"><div class="modal svelte-l2iqfo"><h2 class="svelte-l2iqfo">Create New API Key</h2> <form><div class="form-group svelte-l2iqfo"><label for="name" class="svelte-l2iqfo">Name *</label> <input id="name" type="text" placeholder="e.g., Production Server" required class="svelte-l2iqfo"/></div> <div class="form-group svelte-l2iqfo"><label for="description" class="svelte-l2iqfo">Description</label> <input id="description" type="text" placeholder="What is this key for?" class="svelte-l2iqfo"/></div> <div class="form-group svelte-l2iqfo"><label for="expires" class="svelte-l2iqfo">Expires in (days)</label> <input id="expires" type="number" placeholder="Leave empty for no expiration" min="1" class="svelte-l2iqfo"/></div> <div class="modal-actions svelte-l2iqfo"><button type="button" class="btn btn-secondary svelte-l2iqfo">Cancel</button> <button type="submit" class="btn btn-primary svelte-l2iqfo"> </button></div></form></div></div>'),He=y(`<div class="modal-overlay svelte-l2iqfo"><div class="modal svelte-l2iqfo"><h2 class="svelte-l2iqfo">API Key Created</h2> <div class="warning-banner svelte-l2iqfo">Make sure to copy your API key now. You won't be able to see it again!</div> <div class="key-display svelte-l2iqfo"><code class="svelte-l2iqfo"> </code> <button class="btn btn-secondary btn-sm svelte-l2iqfo">Copy</button></div> <div class="modal-actions svelte-l2iqfo"><button class="btn btn-primary svelte-l2iqfo">Done</button></div></div></div>`),Je=y('<div class="container"><div class="page-header svelte-l2iqfo"><h1 class="svelte-l2iqfo">API Keys</h1> <p class="svelte-l2iqfo">Manage your API keys for programmatic access to the Community Resilience API.</p></div> <!> <div class="card svelte-l2iqfo"><div class="card-header svelte-l2iqfo"><h2 class="svelte-l2iqfo">Your API Keys</h2> <button class="btn btn-primary svelte-l2iqfo">Create New Key</button></div> <!></div></div> <!> <!>',1);function lt(se,ie){Ie(ie,!0);const le=Te();let M=m(Ce([])),S=m(!0),h=m(null),P=m(!1),x=m(""),N=m(""),E=m(null),L=m(!1),k=m(null);Pe(async()=>{if(!le.isAuthenticated){Re("/auth/login");return}await F()});async function F(){l(S,!0),l(h,null);try{const e=await J.auth.getApiKeys();l(M,e.api_keys,!0)}catch(e){l(h,e instanceof Error?e.message:"Failed to load API keys",!0)}l(S,!1)}async function re(){if(t(x).trim()){l(L,!0),l(h,null);try{const e=await J.auth.createApiKey({name:t(x).trim(),description:t(N).trim()||void 0,expires_in_days:t(E)||void 0});l(k,e,!0),await F(),l(x,""),l(N,""),l(E,null)}catch(e){l(h,e instanceof Error?e.message:"Failed to create API key",!0)}l(L,!1)}}async function oe(e){if(confirm("Are you sure you want to revoke this API key? This cannot be undone."))try{await J.auth.revokeApiKey(e),await F()}catch(r){l(h,r instanceof Error?r.message:"Failed to revoke API key",!0)}}function O(){l(k,null),l(P,!1)}function ve(e){navigator.clipboard.writeText(e)}var Q=Je();Se("l2iqfo",e=>{Ne(()=>{Ee.title="API Keys - Community Resilience"})});var R=ae(Q),V=i(s(R),2);{var ne=e=>{var r=Ye(),n=s(r,!0);a(r),D(()=>_(n,t(h))),f(e,r)};w(V,e=>{t(h)&&e(ne)})}var X=i(V,2),T=s(X),ce=i(s(T),2);ce.__click=()=>l(P,!0),a(T);var de=i(T,2);{var fe=e=>{var r=Ue();f(e,r)},ue=e=>{var r=Ke(),n=ae(r);{var u=c=>{var d=We();f(c,d)},p=c=>{var d=Be(),b=i(s(d));Le(b,21,()=>t(M),Me,(q,o)=>{var A=ze(),K=s(A),g=s(K),Y=s(g,!0);a(g);var v=i(g,2);{var ye=I=>{var C=je(),ke=s(C,!0);a(C),D(()=>_(ke,t(o).description)),f(I,C)};w(v,I=>{t(o).description&&I(ye)})}a(K);var U=i(K),$=s(U),be=s($);a($),a(U);var W=i(U),he=s(W,!0);a(W);var j=i(W),qe=s(j,!0);a(j);var z=i(j),B=s(z);let ee;var ge=s(B,!0);a(B),a(z);var te=i(z),xe=s(te);xe.__click=()=>oe(t(o).id),a(te),a(A),D((I,C)=>{_(Y,t(o).name),_(be,`${t(o).key_prefix??""}...`),_(he,I),_(qe,C),ee=Fe(B,1,"status-badge svelte-l2iqfo",null,ee,{active:t(o).is_active}),_(ge,t(o).is_active?"Active":"Inactive")},[()=>t(o).last_used_at?new Date(t(o).last_used_at).toLocaleDateString():"Never",()=>t(o).expires_at?new Date(t(o).expires_at).toLocaleDateString():"Never"]),f(q,A)}),a(b),a(d),f(c,d)};w(n,c=>{t(M).length===0?c(u):c(p,!1)},!0)}f(e,r)};w(de,e=>{t(S)?e(fe):e(ue,!1)})}a(X),a(R);var Z=i(R,2);{var pe=e=>{var r=Ge();r.__click=()=>l(P,!1);var n=s(r);n.__click=v=>v.stopPropagation();var u=i(s(n),2),p=s(u),c=i(s(p),2);G(c),a(p);var d=i(p,2),b=i(s(d),2);G(b),a(d);var q=i(d,2),o=i(s(q),2);G(o),a(q);var A=i(q,2),K=s(A);K.__click=()=>l(P,!1);var g=i(K,2),Y=s(g,!0);a(g),a(A),a(u),a(n),a(r),D(v=>{g.disabled=v,_(Y,t(L)?"Creating...":"Create Key")},[()=>t(L)||!t(x).trim()]),we("submit",u,v=>{v.preventDefault(),re()}),H(c,()=>t(x),v=>l(x,v)),H(b,()=>t(N),v=>l(N,v)),H(o,()=>t(E),v=>l(E,v)),f(e,r)};w(Z,e=>{t(P)&&!t(k)&&e(pe)})}var _e=i(Z,2);{var me=e=>{var r=He();r.__click=O;var n=s(r);n.__click=o=>o.stopPropagation();var u=i(s(n),4),p=s(u),c=s(p,!0);a(p);var d=i(p,2);d.__click=()=>ve(t(k).key),a(u);var b=i(u,2),q=s(b);q.__click=O,a(b),a(n),a(r),D(()=>_(c,t(k).key)),f(e,r)};w(_e,e=>{t(k)&&e(me)})}f(se,Q),De()}Ae(["click"]);export{lt as component};
