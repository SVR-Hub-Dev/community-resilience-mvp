import"../chunks/CWj6FrbW.js";import{o as ze}from"../chunks/DN4i8kDz.js";import{a9 as t,ac as s,a7 as r,a3 as P,g as e,af as _,a5 as d,aj as le,a8 as v,a1 as Oe,a2 as Xe,W as p,ah as Be,b as o,a6 as Re,e as qe,aa as Le,ad as A,ab as Ae,a4 as He,ag as _e,ai as je,ae as Ee}from"../chunks/BkQX6IBl.js";import{i as f}from"../chunks/CmSFReHR.js";import{e as Ne}from"../chunks/DL943SAc.js";import{h as We}from"../chunks/DN-AoazC.js";import{r as K}from"../chunks/TY_SEvFQ.js";import{b as G}from"../chunks/DE88cSuZ.js";import{a as te}from"../chunks/D4n-kpo8.js";import{s as Ge}from"../chunks/t6lN8a7b.js";var Ie=v('<span class="badge badge-info svelte-1xfmgl2" title="Full processing will occur when synced to a local instance">Awaiting Full Processing</span>'),Je=v('<span class="badge badge-mode svelte-1xfmgl2"> </span>'),Ke=v('<span class="badge-group svelte-1xfmgl2"><span> </span> <!></span>');function Qe(V,C){const M={completed:{label:"Fully Processed",class:"badge-success"},needs_local:{label:"Pending Sync",class:"badge-warning"},pending:{label:"Pending",class:"badge-secondary"},processing:{label:"Processing...",class:"badge-primary"},failed:{label:"Failed",class:"badge-danger"}};let q=le(()=>M[C.processingStatus]??{label:C.processingStatus,class:"badge-secondary"}),T=le(()=>C.processingMode==="cloud_basic"?"Basic":C.processingMode==="local_full"?"Full":C.processingMode);var U=Ke(),g=t(U),k=t(g,!0);s(g);var H=r(g,2);{var j=h=>{var x=Ie();d(h,x)},E=h=>{var x=Je(),z=t(x,!0);s(x),P(()=>_(z,e(T))),d(h,x)};f(H,h=>{C.needsFullProcessing?h(j):h(E,!1)})}s(U),P(()=>{Ge(g,1,`badge ${e(q).class??""}`,"svelte-1xfmgl2"),_(k,e(q).label)}),d(V,U)}var Ve=v('<div class="alert alert-error"> </div>'),Ye=v('<div class="alert alert-success"> </div>'),Ze=v(`<div class="info-banner svelte-220hbx"><div class="info-icon svelte-220hbx"><svg viewBox="0 0 20 20" width="20" height="20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div> <div><strong>Cloud Mode</strong> &mdash; Basic text extraction is available for PDF, TXT, and
				MD files. Office documents (DOCX, PPTX, XLSX) and advanced OCR require local processing and
				will be queued for the next sync.</div></div>`),$e=v('<div class="stat-card svelte-220hbx"><span class="stat-value stat-danger svelte-220hbx"> </span> <span class="stat-label svelte-220hbx">Failed</span></div>'),ea=v('<div class="stats-row svelte-220hbx"><div class="stat-card svelte-220hbx"><span class="stat-value svelte-220hbx"> </span> <span class="stat-label svelte-220hbx">Total</span></div> <div class="stat-card svelte-220hbx"><span class="stat-value stat-success svelte-220hbx"> </span> <span class="stat-label svelte-220hbx">Completed</span></div> <div class="stat-card svelte-220hbx"><span class="stat-value stat-warning svelte-220hbx"> </span> <span class="stat-label svelte-220hbx">Awaiting Sync</span></div> <div class="stat-card svelte-220hbx"><span class="stat-value stat-pending svelte-220hbx"> </span> <span class="stat-label svelte-220hbx">Pending</span></div> <!></div>'),aa=v(`<p class="form-hint svelte-220hbx">Supported formats: <strong>PDF, TXT, MD</strong>. Other formats will be accepted and
					queued for full processing during the next local sync.</p>`),sa=v('<span class="btn-spinner svelte-220hbx"></span> Uploading...',1),ta=v('<div class="card form-card svelte-220hbx"><h2 class="svelte-220hbx">Upload Document</h2> <!> <form><div class="form-group svelte-220hbx"><label class="label" for="file">File *</label> <input id="file" type="file" class="input file-input svelte-220hbx" required accept=".pdf,.txt,.md,.docx,.doc,.pptx,.ppt,.xlsx,.xls,.html,.htm,.rtf,.odt,.odp,.ods"/></div> <div class="form-group svelte-220hbx"><label class="label" for="doc-title">Title</label> <input id="doc-title" class="input" placeholder="Auto-filled from filename"/></div> <div class="form-group svelte-220hbx"><label class="label" for="doc-description">Description</label> <textarea id="doc-description" class="textarea" placeholder="Brief description of the document"></textarea></div> <div class="form-row svelte-220hbx"><div class="form-group svelte-220hbx"><label class="label" for="doc-tags">Tags (comma-separated)</label> <input id="doc-tags" class="input" placeholder="flood, evacuation, elderly"/></div> <div class="form-group svelte-220hbx"><label class="label" for="doc-hazard">Hazard Type</label> <input id="doc-hazard" class="input" placeholder="flood, fire, storm"/></div></div> <div class="form-row svelte-220hbx"><div class="form-group svelte-220hbx"><label class="label" for="doc-location">Location</label> <input id="doc-location" class="input" placeholder="Riverside Street"/></div> <div class="form-group svelte-220hbx"><label class="label" for="doc-source">Source</label> <input id="doc-source" class="input" placeholder="Community workshop 2023"/></div></div> <div class="form-actions svelte-220hbx"><button type="button" class="btn btn-secondary">Cancel</button> <button type="submit" class="btn btn-primary"><!></button></div></form></div>'),la=v(`<p class="doc-sync-note svelte-220hbx">Full processing (OCR, structured extraction) will occur when this document is
							synced to a local instance.</p>`),ra=v('<div class="card doc-card svelte-220hbx"><div class="doc-header svelte-220hbx"><h3 class="svelte-220hbx"> </h3> <!></div> <p class="doc-message svelte-220hbx"> </p> <!> <div class="doc-actions svelte-220hbx"><button class="btn btn-secondary btn-sm svelte-220hbx">Refresh Status</button></div></div>'),oa=v('<h2 class="section-title svelte-220hbx">Uploaded Documents</h2> <div class="doc-list svelte-220hbx"></div>',1),ia=v('<div class="card empty-state svelte-220hbx"><p>No documents uploaded yet. Click "Upload Document" to get started.</p></div>'),na=v('<div class="container"><div class="page-header svelte-220hbx"><div class="header-row svelte-220hbx"><h1 class="svelte-220hbx">Documents</h1> <button class="btn btn-primary"> </button></div> <p class="svelte-220hbx">Upload and manage community knowledge documents.</p></div> <!> <!> <!> <!> <!> <!></div>');function ma(V,C){Xe(C,!0);let M=p(""),q=p(""),T=p(!1),U=p(!1),g=p(null),k=p(""),H=p(""),j=p(""),E=p(""),h=p(""),x=p(""),z=p(Be([])),y=p(null),Y=p(!0);ze(async()=>{await re()});async function re(){o(Y,!0);try{const a=await te.documents.getProcessingStats();o(y,a,!0)}catch{}finally{o(Y,!1)}}function ge(a){var i;const l=a.target;if((i=l.files)!=null&&i.length&&(o(g,l.files[0],!0),!e(k))){const u=e(g).name;o(k,u.substring(0,u.lastIndexOf("."))||u,!0)}}function Z(){o(g,null),o(k,""),o(H,""),o(j,""),o(E,""),o(h,""),o(x,""),o(T,!1),o(M,"")}async function he(a){if(a.preventDefault(),!e(g)){o(M,"Please select a file.");return}o(U,!0),o(M,""),o(q,"");try{const l=await te.documents.upload(e(g),{title:e(k)||void 0,description:e(H)||void 0,tags:e(j)||void 0,location:e(E)||void 0,hazard_type:e(h)||void 0,source:e(x)||void 0});o(z,[l,...e(z)],!0),o(q,l.message,!0),Z(),await re()}catch(l){o(M,l instanceof Error?l.message:"Upload failed",!0)}finally{o(U,!1)}}async function me(a){try{const l=await te.documents.getStatus(a);o(z,e(z).map(i=>i.id===a?{...i,processing_status:l.processing_status,processing_mode:l.processing_mode,needs_full_processing:l.needs_full_processing}:i),!0)}catch{}}let oe=le(()=>{var a;return((a=e(y))==null?void 0:a.deployment_mode)==="cloud"});var $=na();We("220hbx",a=>{qe(()=>{Le.title="Documents - Community Resilience"})});var ee=t($),ie=t(ee),ae=r(t(ie),2);ae.__click=()=>{Z(),o(T,!e(T))};var xe=t(ae,!0);s(ae),s(ie),A(2),s(ee);var ne=r(ee,2);{var ye=a=>{var l=Ve(),i=t(l,!0);s(l),P(()=>_(i,e(M))),d(a,l)};f(ne,a=>{e(M)&&a(ye)})}var de=r(ne,2);{var we=a=>{var l=Ye(),i=t(l,!0);s(l),P(()=>_(i,e(q))),d(a,l)};f(de,a=>{e(q)&&a(we)})}var ce=r(de,2);{var De=a=>{var l=Ze();d(a,l)};f(ce,a=>{e(oe)&&a(De)})}var ve=r(ce,2);{var Fe=a=>{var l=ea(),i=t(l),u=t(i),c=t(u,!0);s(u),A(2),s(i);var b=r(i,2),O=t(b),w=t(O,!0);s(O),A(2),s(b);var X=r(b,2),B=t(X),R=t(B,!0);s(B),A(2),s(X);var D=r(X,2),F=t(D),N=t(F,!0);s(F),A(2),s(D);var L=r(D,2);{var W=m=>{var S=$e(),I=t(S),Q=t(I,!0);s(I),A(2),s(S),P(()=>_(Q,e(y).failed)),d(m,S)};f(L,m=>{e(y).failed>0&&m(W)})}s(l),P(()=>{_(c,e(y).total),_(w,e(y).completed),_(R,e(y).needs_local),_(N,e(y).pending)}),d(a,l)};f(ve,a=>{e(y)&&!e(Y)&&a(Fe)})}var ue=r(ve,2);{var Se=a=>{var l=ta(),i=r(t(l),2);{var u=n=>{var J=aa();d(n,J)};f(i,n=>{e(oe)&&n(u)})}var c=r(i,2),b=t(c),O=r(t(b),2);O.__change=ge,s(b);var w=r(b,2),X=r(t(w),2);K(X),s(w);var B=r(w,2),R=r(t(B),2);Ae(R),s(B);var D=r(B,2),F=t(D),N=r(t(F),2);K(N),s(F);var L=r(F,2),W=r(t(L),2);K(W),s(L),s(D);var m=r(D,2),S=t(m),I=r(t(S),2);K(I),s(S);var Q=r(S,2),pe=r(t(Q),2);K(pe),s(Q),s(m);var be=r(m,2),fe=t(be);fe.__click=Z;var se=r(fe,2),Te=t(se);{var Ue=n=>{var J=sa();A(),d(n,J)},ke=n=>{var J=Ee("Upload");d(n,J)};f(Te,n=>{e(U)?n(Ue):n(ke,!1)})}s(se),s(be),s(c),s(l),P(()=>se.disabled=e(U)||!e(g)),He("submit",c,he),G(X,()=>e(k),n=>o(k,n)),G(R,()=>e(H),n=>o(H,n)),G(N,()=>e(j),n=>o(j,n)),G(W,()=>e(h),n=>o(h,n)),G(I,()=>e(E),n=>o(E,n)),G(pe,()=>e(x),n=>o(x,n)),d(a,l)};f(ue,a=>{e(T)&&a(Se)})}var Pe=r(ue,2);{var Ce=a=>{var l=oa(),i=r(_e(l),2);Ne(i,21,()=>e(z),u=>u.id,(u,c)=>{var b=ra(),O=t(b),w=t(O),X=t(w,!0);s(w);var B=r(w,2);Qe(B,{get processingStatus(){return e(c).processing_status},get processingMode(){return e(c).processing_mode},get needsFullProcessing(){return e(c).needs_full_processing}}),s(O);var R=r(O,2),D=t(R,!0);s(R);var F=r(R,2);{var N=m=>{var S=la();d(m,S)};f(F,m=>{e(c).needs_full_processing&&m(N)})}var L=r(F,2),W=t(L);W.__click=()=>me(e(c).id),s(L),s(b),P(()=>{_(X,e(c).title),_(D,e(c).message)}),d(u,b)}),s(i),d(a,l)},Me=a=>{var l=je(),i=_e(l);{var u=c=>{var b=ia();d(c,b)};f(i,c=>{e(T)||c(u)},!0)}d(a,l)};f(Pe,a=>{e(z).length>0?a(Ce):a(Me,!1)})}s($),P(()=>_(xe,e(T)?"Cancel":"Upload Document")),d(V,$),Re()}Oe(["click","change"]);export{ma as component};
