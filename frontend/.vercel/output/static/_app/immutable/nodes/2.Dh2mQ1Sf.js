import{a as d,f as u,t as fa}from"../chunks/deXkMWSk.js";import{z as ga,A as k,B as e,C as ba,D as s,F as r,e as ya,$ as xa,G as M,I as t,J as l,K as f,M as ka,O as wa}from"../chunks/xmsiYLBb.js";import{d as Sa,e as $a,s as g}from"../chunks/BjJ1wdql.js";import{i as b}from"../chunks/Iv35OxqL.js";import{h as Ca,b as O,a as Q,e as U,i as V}from"../chunks/BqvhUv_W.js";import{s as H}from"../chunks/CvX7yBP0.js";var Fa=u('<span class="spinner-small svelte-1uha8ag"></span> Analyzing...',1),Ra=u('<div class="alert alert-error"> </div>'),Aa=u('<div class="loading"><div class="spinner"></div></div>'),Da=u('<div><div class="action-header svelte-1uha8ag"><span> </span></div> <div class="action-content"><p class="action-text svelte-1uha8ag"> </p> <p class="action-rationale svelte-1uha8ag"> </p></div></div>'),za=u('<div class="card knowledge-used svelte-1uha8ag"><h3 class="svelte-1uha8ag">Knowledge Used</h3> <p class="svelte-1uha8ag"> </p></div>'),Ea=u('<div class="alert alert-success">Thank you for your feedback!</div>'),Pa=u('<button type="button"> </button>'),Ta=u('<div class="feedback-form svelte-1uha8ag"><label class="label" for="comments">Additional comments (optional)</label> <textarea id="comments" class="textarea svelte-1uha8ag" placeholder="What could be improved?"></textarea> <button type="button" class="btn btn-primary">Submit Feedback</button></div>'),qa=u('<div class="rating-buttons svelte-1uha8ag"></div> <p class="rating-hint svelte-1uha8ag">1 = Not helpful, 5 = Very helpful</p> <!>',1),Ga=u('<div class="results svelte-1uha8ag"><div class="card summary-card svelte-1uha8ag"><h2 class="svelte-1uha8ag">Situation Summary</h2> <p> </p></div> <div class="actions-section svelte-1uha8ag"><h2 class="svelte-1uha8ag">Recommended Actions</h2> <div class="actions-list svelte-1uha8ag"></div></div> <!> <div class="card feedback-section svelte-1uha8ag"><h3 class="svelte-1uha8ag">Was this helpful?</h3> <!></div></div>'),Ha=u(`<div class="container"><div class="page-header svelte-1uha8ag"><h1 class="svelte-1uha8ag">Disaster Response Assistant</h1> <p class="svelte-1uha8ag">Describe your current situation to receive prioritized action recommendations based on local community knowledge.</p></div> <div class="query-section card svelte-1uha8ag"><form><label class="label" for="situation">Current Situation</label> <textarea id="situation" class="textarea" placeholder="Describe what's happening. Example: Heavy rain, Riverside Street flooding, power out in the area..."></textarea> <div class="submit-row svelte-1uha8ag"><button type="submit" class="btn btn-primary"><!></button></div></form></div> <!> <!> <!></div>`);function La(j,X){ga(X,!0);let w=f(""),y=f(!1),S=f(""),h=f(null),z=f(!1),x=f(0),R=f("");async function Y(a){if(a.preventDefault(),!!e(w).trim()){l(y,!0),l(S,""),l(h,null),l(z,!1),l(x,0),l(R,"");try{l(h,await Q.query(e(w)),!0)}catch(i){l(S,i instanceof Error?i.message:"Failed to get recommendations",!0)}finally{l(y,!1)}}}async function Z(){if(!(!e(h)||e(x)===0))try{await Q.submitFeedback({log_id:e(h).log_id,rating:e(x),comments:e(R)||void 0}),l(z,!0)}catch(a){l(S,a instanceof Error?a.message:"Failed to submit feedback",!0)}}function aa(a){return a===1?"priority-1":a===2?"priority-2":"priority-3"}function ea(a){return a===1?"Critical":a===2?"High":"Normal"}var E=Ha();Ca("1uha8ag",a=>{ya(()=>{xa.title="Community Resilience - Query"})});var P=s(r(E),2),T=r(P),A=s(r(T),2);M(A);var K=s(A,2),q=r(K),ta=r(q);{var ra=a=>{var i=Fa();ka(),d(a,i)},sa=a=>{var i=fa("Get Recommendations");d(a,i)};b(ta,a=>{e(y)?a(ra):a(sa,!1)})}t(q),t(K),t(T),t(P);var N=s(P,2);{var ia=a=>{var i=Ra(),$=r(i,!0);t(i),k(()=>g($,e(S))),d(a,i)};b(N,a=>{e(S)&&a(ia)})}var W=s(N,2);{var oa=a=>{var i=Aa();d(a,i)};b(W,a=>{e(y)&&a(oa)})}var la=s(W,2);{var va=a=>{var i=Ga(),$=r(i),B=s(r($),2),na=r(B,!0);t(B),t($);var G=s($,2),I=s(r(G),2);U(I,21,()=>e(h).actions,V,(n,o)=>{var c=Da(),p=r(c),C=r(p),_=r(C);t(C),t(p);var m=s(p,2),v=r(m),F=r(v,!0);t(v);var D=s(v,2),ha=r(D,!0);t(D),t(m),t(c),k((pa,_a)=>{H(c,1,`action-card card ${pa??""}`,"svelte-1uha8ag"),H(C,1,`badge badge-${e(o).priority===1?"danger":e(o).priority===2?"warning":"primary"}`),g(_,`Priority ${e(o).priority??""}: ${_a??""}`),g(F,e(o).action),g(ha,e(o).rationale)},[()=>aa(e(o).priority),()=>ea(e(o).priority)]),d(n,c)}),t(I),t(G);var J=s(G,2);{var da=n=>{var o=za(),c=s(r(o),2),p=r(c);t(c),t(o),k(()=>g(p,`This response was informed by ${e(h).retrieved_knowledge_ids.length??""} knowledge entries from the community database.`)),d(n,o)};b(J,n=>{e(h).retrieved_knowledge_ids.length>0&&n(da)})}var L=s(J,2),ca=s(r(L),2);{var ua=n=>{var o=Ea();d(n,o)},ma=n=>{var o=qa(),c=wa(o);U(c,20,()=>[1,2,3,4,5],V,(_,m)=>{var v=Pa();v.__click=()=>l(x,m,!0);var F=r(v,!0);t(v),k(()=>{H(v,1,`rating-btn ${e(x)===m?"active":""}`,"svelte-1uha8ag"),g(F,m)}),d(_,v)}),t(c);var p=s(c,4);{var C=_=>{var m=Ta(),v=s(r(m),2);M(v);var F=s(v,2);F.__click=Z,t(m),O(v,()=>e(R),D=>l(R,D)),d(_,m)};b(p,_=>{e(x)>0&&_(C)})}d(n,o)};b(ca,n=>{e(z)?n(ua):n(ma,!1)})}t(L),t(i),k(()=>g(na,e(h).summary)),d(a,i)};b(la,a=>{e(h)&&a(va)})}t(E),k(a=>{A.disabled=e(y),q.disabled=a},[()=>e(y)||!e(w).trim()]),$a("submit",T,Y),O(A,()=>e(w),a=>l(w,a)),d(j,E),ba()}Sa(["click"]);export{La as component};
