import{s as l,a as d,f as y,d as kt,c as Tt}from"../chunks/DrEVJf_X.js";import{o as At}from"../chunks/CY6dNTIf.js";import{a0 as yt,a4 as s,a7 as e,a3 as r,a1 as g,g as t,a2 as _t,an as D,a8 as C,ab as Ct,b,e as Et,a5 as Rt,a9 as at,aa as vt,ao as St}from"../chunks/BIQOLOFU.js";import{i as k}from"../chunks/NPzolRrf.js";import{e as st,i as dt}from"../chunks/BPKzcg-U.js";import{h as Gt}from"../chunks/82X_sTQh.js";import{s as Ht,r as Lt,b as zt}from"../chunks/CDiOZD_h.js";import{s as ot}from"../chunks/DrIL6A14.js";import{a as ct}from"../chunks/D6zz_Kj-.js";import{s as nt}from"../chunks/Bz7eZnhB.js";var It=y('<span class="subtype svelte-1ba0tyl"> </span>'),Kt=y('<p class="entity-location svelte-1ba0tyl"> </p>'),Mt=y('<span class="method-badge svelte-1ba0tyl"> </span>'),Pt=y('<a class="entity-card svelte-1ba0tyl"><div class="entity-header svelte-1ba0tyl"><span class="type-icon svelte-1ba0tyl"> </span> <div class="entity-info svelte-1ba0tyl"><h3 class="entity-name svelte-1ba0tyl"> </h3> <div class="entity-type-row svelte-1ba0tyl"><span class="type-badge svelte-1ba0tyl"> </span> <!></div></div></div> <!> <div class="entity-footer svelte-1ba0tyl"><div class="confidence svelte-1ba0tyl"><div class="confidence-bar svelte-1ba0tyl"><div class="confidence-fill svelte-1ba0tyl"></div></div> <span class="confidence-label svelte-1ba0tyl"> </span></div> <!></div></a>');function Ft(J,v){yt(v,!0);const V={HazardType:"#dc2626",Community:"#2563eb",Agency:"#7c3aed",Location:"#059669",Resource:"#d97706",Action:"#0891b2"},H={HazardType:"H",Community:"C",Agency:"A",Location:"L",Resource:"R",Action:"X"};let _=D(()=>V[v.entity.entity_type]||"#6b7280"),L=D(()=>H[v.entity.entity_type]||"?"),E=D(()=>Math.round(v.entity.confidence_score*100));var f=Pt(),u=s(f),h=s(u),z=s(h,!0);e(h);var R=r(h,2),I=s(R),O=s(I,!0);e(I);var Q=r(I,2),x=s(Q),U=s(x,!0);e(x);var W=r(x,2);{var X=o=>{var c=It(),A=s(c,!0);e(c),g(()=>l(A,v.entity.entity_subtype)),d(o,c)};k(W,o=>{v.entity.entity_subtype&&o(X)})}e(Q),e(R),e(u);var q=r(u,2);{var K=o=>{var c=Kt(),A=s(c,!0);e(c),g(()=>l(A,v.entity.location_text)),d(o,c)};k(q,o=>{v.entity.location_text&&o(K)})}var S=r(q,2),T=s(S),G=s(T),Z=s(G);e(G);var M=r(G,2),P=s(M);e(M),e(T);var F=r(T,2);{var B=o=>{var c=Mt(),A=s(c,!0);e(c),g(()=>l(A,v.entity.extraction_method)),d(o,c)};k(F,o=>{v.entity.extraction_method&&o(B)})}e(S),e(f),g(()=>{Ht(f,"href",`/knowledge-graph/${v.entity.id??""}`),nt(h,`background: ${t(_)??""}`),l(z,t(L)),l(O,v.entity.name),nt(x,`color: ${t(_)??""}; border-color: ${t(_)??""}`),l(U,v.entity.entity_type),nt(Z,`width: ${t(E)??""}%; background: ${t(_)??""}`),l(P,`${t(E)??""}%`)}),d(J,f),_t()}var Nt=y('<div class="alert alert-error"> </div>'),Yt=y('<div class="stat-card stat-card-small svelte-n1dg1y"><span class="stat-value svelte-n1dg1y"> </span> <span class="stat-label svelte-n1dg1y"> </span></div>'),jt=y('<div class="stats-row svelte-n1dg1y"><div class="stat-card svelte-n1dg1y"><span class="stat-value svelte-n1dg1y"> </span> <span class="stat-label svelte-n1dg1y">Entities</span></div> <div class="stat-card svelte-n1dg1y"><span class="stat-value svelte-n1dg1y"> </span> <span class="stat-label svelte-n1dg1y">Relationships</span></div> <div class="stat-card svelte-n1dg1y"><span class="stat-value svelte-n1dg1y"> </span> <span class="stat-label svelte-n1dg1y">Avg Confidence</span></div> <!></div>'),Ot=y("<button> </button>"),Qt=y("&middot; filtered by <strong> </strong>",1),Ut=y('<div class="loading"><div class="spinner"></div></div>'),Xt=y('<div class="card empty-state svelte-n1dg1y"><p>No knowledge graph entities found. Upload documents to start extracting structured knowledge.</p></div>'),qt=y('<div class="entities-grid svelte-n1dg1y"></div>'),Bt=y('<div class="container"><div class="page-header svelte-n1dg1y"><div class="header-row svelte-n1dg1y"><h1 class="svelte-n1dg1y">Knowledge Graph</h1></div> <p class="svelte-n1dg1y">Structured entities and relationships extracted from community documents.</p></div> <!> <!> <div class="filters-bar svelte-n1dg1y"><div class="type-filters svelte-n1dg1y"><button>All</button> <!></div> <div class="search-box svelte-n1dg1y"><input type="text" class="input search-input svelte-n1dg1y" placeholder="Search entities..."/></div></div> <p class="results-count svelte-n1dg1y"> <!></p> <!></div>');function ne(J,v){yt(v,!0);const V=["HazardType","Community","Agency","Location","Resource","Action"];let H=C(Ct([])),_=C(null),L=C(0),E=C(!0),f=C(""),u=C(""),h=C(""),z=null;At(async()=>{await Promise.all([R(),I()])});async function R(){b(E,!0),b(f,"");try{const a=await ct.knowledgeGraph.getEntities({entity_type:t(u)||void 0,search:t(h)||void 0,limit:100});b(H,a.entities,!0),b(L,a.total,!0)}catch(a){b(f,a instanceof Error?a.message:"Failed to load entities",!0)}finally{b(E,!1)}}async function I(){try{b(_,await ct.knowledgeGraph.getStatistics(),!0)}catch{}}function O(a){b(u,a===t(u)?"":a,!0),R()}function Q(a){const n=a.target;b(h,n.value,!0),z&&clearTimeout(z),z=setTimeout(()=>{R()},300)}var x=Bt();Gt("n1dg1y",a=>{Et(()=>{Rt.title="Knowledge Graph - Community Resilience"})});var U=r(s(x),2);{var W=a=>{var n=Nt(),i=s(n,!0);e(n),g(()=>l(i,t(f))),d(a,n)};k(U,a=>{t(f)&&a(W)})}var X=r(U,2);{var q=a=>{var n=jt(),i=s(n),m=s(i),N=s(m,!0);e(m),at(2),e(i);var p=r(i,2),w=s(p),Y=s(w,!0);e(w),at(2),e(p);var j=r(p,2),rt=s(j),gt=s(rt);e(rt),at(2),e(j);var ft=r(j,2);st(ft,17,()=>Object.entries(t(_).entity_counts),dt,($,mt)=>{var it=D(()=>St(t(mt),2));let bt=()=>t(it)[0],ht=()=>t(it)[1];var tt=Yt(),et=s(tt),xt=s(et,!0);e(et);var lt=r(et,2),wt=s(lt,!0);e(lt),e(tt),g(()=>{l(xt,ht()),l(wt,bt())}),d($,tt)}),e(n),g($=>{l(N,t(_).total_entities),l(Y,t(_).total_relationships),l(gt,`${$??""}%`)},[()=>Math.round(t(_).avg_confidence*100)]),d(a,n)};k(X,a=>{t(_)&&a(q)})}var K=r(X,2),S=s(K),T=s(S);let G;T.__click=()=>O("");var Z=r(T,2);st(Z,17,()=>V,dt,(a,n)=>{var i=Ot();let m;i.__click=()=>O(t(n));var N=s(i,!0);e(i),g(()=>{m=ot(i,1,"filter-btn svelte-n1dg1y",null,m,{active:t(u)===t(n)}),l(N,t(n))}),d(a,i)}),e(S);var M=r(S,2),P=s(M);Lt(P),P.__input=Q,e(M),e(K);var F=r(K,2),B=s(F),o=r(B);{var c=a=>{var n=Qt(),i=r(vt(n)),m=s(i,!0);e(i),g(()=>l(m,t(u))),d(a,n)};k(o,a=>{t(u)&&a(c)})}e(F);var A=r(F,2);{var ut=a=>{var n=Ut();d(a,n)},pt=a=>{var n=Tt(),i=vt(n);{var m=p=>{var w=Xt();d(p,w)},N=p=>{var w=qt();st(w,21,()=>t(H),Y=>Y.id,(Y,j)=>{Ft(Y,{get entity(){return t(j)}})}),e(w),d(p,w)};k(i,p=>{t(H).length===0?p(m):p(N,!1)},!0)}d(a,n)};k(A,a=>{t(E)?a(ut):a(pt,!1)})}e(x),g(()=>{G=ot(T,1,"filter-btn svelte-n1dg1y",null,G,{active:t(u)===""}),zt(P,t(h)),l(B,`${t(L)??""} ${t(L)===1?"entity":"entities"} found `)}),d(J,x),_t()}kt(["click","input"]);export{ne as component};
