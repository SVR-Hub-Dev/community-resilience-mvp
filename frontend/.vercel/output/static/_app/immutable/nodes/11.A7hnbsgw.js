import{d as ze,a as c,f as p,s as m,e as Ce,c as Ke}from"../chunks/DrEVJf_X.js";import{o as Te}from"../chunks/CY6dNTIf.js";import{a0 as Fe,a8 as _,ab as Ae,b as a,g as e,a1 as g,a2 as De,e as Se,a3 as i,a5 as Be,a4 as s,a7 as r,a9 as qe,a6 as Ne,aa as Re}from"../chunks/BIQOLOFU.js";import{i as h}from"../chunks/NPzolRrf.js";import{e as ve,i as oe}from"../chunks/BPKzcg-U.js";import{h as $e}from"../chunks/82X_sTQh.js";import{r as M}from"../chunks/CDiOZD_h.js";import{b as A}from"../chunks/COIuQCY0.js";import{a as P}from"../chunks/D6zz_Kj-.js";var je=p('<div class="alert alert-error"> </div>'),He=p('<div class="card form-card svelte-u7nvcr"><h2 class="svelte-u7nvcr"> </h2> <form><div class="form-group svelte-u7nvcr"><label class="label" for="title">Title *</label> <input id="title" class="input" required/></div> <div class="form-group svelte-u7nvcr"><label class="label" for="description">Description *</label> <textarea id="description" class="textarea" required></textarea></div> <div class="form-row svelte-u7nvcr"><div class="form-group svelte-u7nvcr"><label class="label" for="tags">Tags (comma-separated)</label> <input id="tags" class="input" placeholder="flood, evacuation, elderly"/></div> <div class="form-group svelte-u7nvcr"><label class="label" for="hazardType">Hazard Type</label> <input id="hazardType" class="input" placeholder="flood, fire, storm"/></div></div> <div class="form-row svelte-u7nvcr"><div class="form-group svelte-u7nvcr"><label class="label" for="location">Location</label> <input id="location" class="input" placeholder="Riverside Street"/></div> <div class="form-group svelte-u7nvcr"><label class="label" for="source">Source</label> <input id="source" class="input" placeholder="Community workshop 2023"/></div></div> <div class="form-actions svelte-u7nvcr"><button type="button" class="btn btn-secondary">Cancel</button> <button type="submit" class="btn btn-primary"> </button></div></form></div>'),Ie=p('<div class="loading"><div class="spinner"></div></div>'),Le=p('<div class="card empty-state svelte-u7nvcr"><p>No knowledge entries yet. Add your first entry to get started.</p></div>'),Me=p('<span class="meta-item svelte-u7nvcr"> </span>'),Ue=p('<span class="badge badge-warning"> </span>'),Ge=p('<span class="badge badge-primary"> </span>'),Je=p('<div class="entry-tags svelte-u7nvcr"></div>'),Oe=p('<p class="entry-source svelte-u7nvcr"> </p>'),Pe=p('<div class="card entry-card svelte-u7nvcr"><div class="entry-header svelte-u7nvcr"><h3 class="svelte-u7nvcr"> </h3> <div class="entry-actions svelte-u7nvcr"><button class="btn-icon svelte-u7nvcr" title="Edit">‚úèÔ∏è</button> <button class="btn-icon svelte-u7nvcr" title="Delete">üóëÔ∏è</button></div></div> <p class="entry-description svelte-u7nvcr"> </p> <div class="entry-meta svelte-u7nvcr"><!> <!></div> <!> <!></div>'),Qe=p('<div class="entries-grid svelte-u7nvcr"></div>'),Ve=p('<div class="container"><div class="page-header svelte-u7nvcr"><div class="header-row svelte-u7nvcr"><h1 class="svelte-u7nvcr">Knowledge Base</h1> <button class="btn btn-primary"> </button></div> <p class="svelte-u7nvcr">Community knowledge entries used for disaster response recommendations.</p></div> <!> <!> <!></div>');function ia(ne,de){Fe(de,!0);let Q=_(Ae([])),V=_(!0),y=_(""),k=_(!1),z=_(null),D=_(""),S=_(""),B=_(""),q=_(""),N=_(""),R=_("");Te(async()=>{await W()});async function W(){a(V,!0),a(y,"");try{a(Q,await P.getKnowledge(),!0)}catch(t){a(y,t instanceof Error?t.message:"Failed to load knowledge entries",!0)}finally{a(V,!1)}}function X(){a(D,""),a(S,""),a(B,""),a(q,""),a(N,""),a(R,""),a(z,null),a(k,!1)}function ce(t){var l;a(D,t.title,!0),a(S,t.description,!0),a(B,((l=t.tags)==null?void 0:l.join(", "))||"",!0),a(q,t.location||"",!0),a(N,t.hazard_type||"",!0),a(R,t.source||"",!0),a(z,t.id,!0),a(k,!0)}async function ue(t){t.preventDefault(),a(y,"");const l={title:e(D),description:e(S),tags:e(B).split(",").map(u=>u.trim()).filter(Boolean),location:e(q)||null,hazard_type:e(N)||null,source:e(R)||null};try{e(z)?await P.updateKnowledge(e(z),l):await P.createKnowledge(l),X(),await W()}catch(u){a(y,u instanceof Error?u.message:"Failed to save entry",!0)}}async function pe(t){if(confirm("Are you sure you want to delete this entry?"))try{await P.deleteKnowledge(t),await W()}catch(l){a(y,l instanceof Error?l.message:"Failed to delete entry",!0)}}var Y=Ve();$e("u7nvcr",t=>{Se(()=>{Be.title="Knowledge Base - Community Resilience"})});var Z=s(Y),se=s(Z),ee=i(s(se),2);ee.__click=()=>{X(),a(k,!e(k))};var _e=s(ee,!0);r(ee),r(se),qe(2),r(Z);var ie=i(Z,2);{var fe=t=>{var l=je(),u=s(l,!0);r(l),g(()=>m(u,e(y))),c(t,l)};h(ie,t=>{e(y)&&t(fe)})}var le=i(ie,2);{var me=t=>{var l=He(),u=s(l),ae=s(u,!0);r(u);var $=i(u,2),f=s($),b=i(s(f),2);M(b),r(f);var j=i(f,2),o=i(s(j),2);Ne(o),r(j);var w=i(j,2),x=s(w),C=i(s(x),2);M(C),r(x);var U=i(x,2),H=i(s(U),2);M(H),r(U),r(w);var K=i(w,2),I=s(K),T=i(s(I),2);M(T),r(I);var G=i(I,2),F=i(s(G),2);M(F),r(G),r(K);var L=i(K,2),J=s(L);J.__click=X;var O=i(J,2),te=s(O);r(O),r(L),r($),r(l),g(()=>{m(ae,e(z)?"Edit Entry":"Add New Entry"),m(te,`${e(z)?"Update":"Create"} Entry`)}),Ce("submit",$,ue),A(b,()=>e(D),d=>a(D,d)),A(o,()=>e(S),d=>a(S,d)),A(C,()=>e(B),d=>a(B,d)),A(H,()=>e(N),d=>a(N,d)),A(T,()=>e(q),d=>a(q,d)),A(F,()=>e(R),d=>a(R,d)),c(t,l)};h(le,t=>{e(k)&&t(me)})}var be=i(le,2);{var ge=t=>{var l=Ie();c(t,l)},he=t=>{var l=Ke(),u=Re(l);{var ae=f=>{var b=Le();c(f,b)},$=f=>{var b=Qe();ve(b,21,()=>e(Q),oe,(j,o)=>{var w=Pe(),x=s(w),C=s(x),U=s(C,!0);r(C);var H=i(C,2),K=s(H);K.__click=()=>ce(e(o));var I=i(K,2);I.__click=()=>pe(e(o).id),r(H),r(x);var T=i(x,2),G=s(T,!0);r(T);var F=i(T,2),L=s(F);{var J=n=>{var v=Me(),E=s(v);r(v),g(()=>m(E,`üìç ${e(o).location??""}`)),c(n,v)};h(L,n=>{e(o).location&&n(J)})}var O=i(L,2);{var te=n=>{var v=Ue(),E=s(v,!0);r(v),g(()=>m(E,e(o).hazard_type)),c(n,v)};h(O,n=>{e(o).hazard_type&&n(te)})}r(F);var d=i(F,2);{var ye=n=>{var v=Je();ve(v,21,()=>e(o).tags,oe,(E,Ee)=>{var re=Ge(),ke=s(re,!0);r(re),g(()=>m(ke,e(Ee))),c(E,re)}),r(v),c(n,v)};h(d,n=>{var v;(v=e(o).tags)!=null&&v.length&&n(ye)})}var we=i(d,2);{var xe=n=>{var v=Oe(),E=s(v);r(v),g(()=>m(E,`Source: ${e(o).source??""}`)),c(n,v)};h(we,n=>{e(o).source&&n(xe)})}r(w),g(()=>{m(U,e(o).title),m(G,e(o).description)}),c(j,w)}),r(b),c(f,b)};h(u,f=>{e(Q).length===0?f(ae):f($,!1)},!0)}c(t,l)};h(be,t=>{e(V)?t(ge):t(he,!1)})}r(Y),g(()=>m(_e,e(k)?"Cancel":"Add Entry")),c(ne,Y),De()}ze(["click"]);export{ia as component};
