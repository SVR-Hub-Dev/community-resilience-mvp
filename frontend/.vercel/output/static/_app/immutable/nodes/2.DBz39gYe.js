import"../chunks/CWj6FrbW.js";import{a1 as _a,a2 as ga,a3 as k,a4 as ba,g as e,a5 as d,a6 as ya,a7 as s,a8 as u,a9 as r,e as xa,aa as ka,ab as j,ac as t,b as l,W as _,ad as wa,ae as Sa,af as g,ag as Ra}from"../chunks/BkQX6IBl.js";import{i as b}from"../chunks/CmSFReHR.js";import{e as B,i as I}from"../chunks/DL943SAc.js";import{h as $a}from"../chunks/DN-AoazC.js";import{s as H}from"../chunks/t6lN8a7b.js";import{b as J}from"../chunks/DE88cSuZ.js";import{a as M}from"../chunks/D4n-kpo8.js";var Ca=u('<span class="spinner-small svelte-1uha8ag"></span> Analyzing...',1),Fa=u('<div class="alert alert-error"> </div>'),Aa=u('<div class="loading"><div class="spinner"></div></div>'),Da=u('<div><div class="action-header svelte-1uha8ag"><span> </span></div> <div class="action-content"><p class="action-text svelte-1uha8ag"> </p> <p class="action-rationale svelte-1uha8ag"> </p></div></div>'),Ea=u('<div class="card knowledge-used svelte-1uha8ag"><h3 class="svelte-1uha8ag">Knowledge Used</h3> <p class="svelte-1uha8ag"> </p></div>'),Pa=u('<div class="alert alert-success">Thank you for your feedback!</div>'),Ta=u('<button type="button"> </button>'),Wa=u('<div class="feedback-form svelte-1uha8ag"><label class="label" for="comments">Additional comments (optional)</label> <textarea id="comments" class="textarea svelte-1uha8ag" placeholder="What could be improved?"></textarea> <button type="button" class="btn btn-primary">Submit Feedback</button></div>'),qa=u('<div class="rating-buttons svelte-1uha8ag"></div> <p class="rating-hint svelte-1uha8ag">1 = Not helpful, 5 = Very helpful</p> <!>',1),za=u('<div class="results svelte-1uha8ag"><div class="card summary-card svelte-1uha8ag"><h2 class="svelte-1uha8ag">Situation Summary</h2> <p> </p></div> <div class="actions-section svelte-1uha8ag"><h2 class="svelte-1uha8ag">Recommended Actions</h2> <div class="actions-list svelte-1uha8ag"></div></div> <!> <div class="card feedback-section svelte-1uha8ag"><h3 class="svelte-1uha8ag">Was this helpful?</h3> <!></div></div>'),Ha=u(`<div class="container"><div class="page-header svelte-1uha8ag"><h1 class="svelte-1uha8ag">Disaster Response Assistant</h1> <p class="svelte-1uha8ag">Describe your current situation to receive prioritized action recommendations based on local community knowledge.</p></div> <div class="query-section card svelte-1uha8ag"><form><label class="label" for="situation">Current Situation</label> <textarea id="situation" class="textarea" placeholder="Describe what's happening. Example: Heavy rain, Riverside Street flooding, power out in the area..."></textarea> <div class="submit-row svelte-1uha8ag"><button type="submit" class="btn btn-primary"><!></button></div></form></div> <!> <!> <!></div>`);function Ba(O,X){ga(X,!0);let w=_(""),y=_(!1),S=_(""),p=_(null),E=_(!1),x=_(0),F=_("");async function Y(a){if(a.preventDefault(),!!e(w).trim()){l(y,!0),l(S,""),l(p,null),l(E,!1),l(x,0),l(F,"");try{l(p,await M.query(e(w)),!0)}catch(i){l(S,i instanceof Error?i.message:"Failed to get recommendations",!0)}finally{l(y,!1)}}}async function Z(){if(!(!e(p)||e(x)===0))try{await M.submitFeedback({log_id:e(p).log_id,rating:e(x),comments:e(F)||void 0}),l(E,!0)}catch(a){l(S,a instanceof Error?a.message:"Failed to submit feedback",!0)}}function aa(a){return a===1?"priority-1":a===2?"priority-2":"priority-3"}function ea(a){return a===1?"Critical":a===2?"High":"Normal"}var P=Ha();$a("1uha8ag",a=>{xa(()=>{ka.title="Community Resilience - Query"})});var T=s(r(P),2),W=r(T),A=s(r(W),2);j(A);var N=s(A,2),q=r(N),ta=r(q);{var ra=a=>{var i=Ca();wa(),d(a,i)},sa=a=>{var i=Sa("Get Recommendations");d(a,i)};b(ta,a=>{e(y)?a(ra):a(sa,!1)})}t(q),t(N),t(W),t(T);var G=s(T,2);{var ia=a=>{var i=Fa(),R=r(i,!0);t(i),k(()=>g(R,e(S))),d(a,i)};b(G,a=>{e(S)&&a(ia)})}var K=s(G,2);{var oa=a=>{var i=Aa();d(a,i)};b(K,a=>{e(y)&&a(oa)})}var la=s(K,2);{var va=a=>{var i=za(),R=r(i),L=s(r(R),2),na=r(L,!0);t(L),t(R);var z=s(R,2),Q=s(r(z),2);B(Q,21,()=>e(p).actions,I,(n,o)=>{var c=Da(),h=r(c),$=r(h),f=r($);t($),t(h);var m=s(h,2),v=r(m),C=r(v,!0);t(v);var D=s(v,2),pa=r(D,!0);t(D),t(m),t(c),k((ha,fa)=>{H(c,1,`action-card card ${ha??""}`,"svelte-1uha8ag"),H($,1,`badge badge-${e(o).priority===1?"danger":e(o).priority===2?"warning":"primary"}`),g(f,`Priority ${e(o).priority??""}: ${fa??""}`),g(C,e(o).action),g(pa,e(o).rationale)},[()=>aa(e(o).priority),()=>ea(e(o).priority)]),d(n,c)}),t(Q),t(z);var U=s(z,2);{var da=n=>{var o=Ea(),c=s(r(o),2),h=r(c);t(c),t(o),k(()=>g(h,`This response was informed by ${e(p).retrieved_knowledge_ids.length??""} knowledge entries from the community database.`)),d(n,o)};b(U,n=>{e(p).retrieved_knowledge_ids.length>0&&n(da)})}var V=s(U,2),ca=s(r(V),2);{var ua=n=>{var o=Pa();d(n,o)},ma=n=>{var o=qa(),c=Ra(o);B(c,20,()=>[1,2,3,4,5],I,(f,m)=>{var v=Ta();v.__click=()=>l(x,m,!0);var C=r(v,!0);t(v),k(()=>{H(v,1,`rating-btn ${e(x)===m?"active":""}`,"svelte-1uha8ag"),g(C,m)}),d(f,v)}),t(c);var h=s(c,4);{var $=f=>{var m=Wa(),v=s(r(m),2);j(v);var C=s(v,2);C.__click=Z,t(m),J(v,()=>e(F),D=>l(F,D)),d(f,m)};b(h,f=>{e(x)>0&&f($)})}d(n,o)};b(ca,n=>{e(E)?n(ua):n(ma,!1)})}t(V),t(i),k(()=>g(na,e(p).summary)),d(a,i)};b(la,a=>{e(p)&&a(va)})}t(P),k(a=>{A.disabled=e(y),q.disabled=a},[()=>e(y)||!e(w).trim()]),ba("submit",W,Y),J(A,()=>e(w),a=>l(w,a)),d(O,P),ya()}_a(["click"]);export{Ba as component};
