import{s as _,a as d,f as v,d as ze,e as Oe,c as Xe,t as Be}from"../chunks/DrEVJf_X.js";import{o as Re}from"../chunks/CY6dNTIf.js";import{a4 as s,a7 as a,a3 as r,a1 as P,g as e,an as le,a0 as qe,a8 as p,ab as Le,b as o,a2 as Ae,e as He,a5 as Ee,a9 as A,a6 as Ne,aa as _e}from"../chunks/BIQOLOFU.js";import{i as f}from"../chunks/NPzolRrf.js";import{e as je}from"../chunks/BPKzcg-U.js";import{h as Ge}from"../chunks/82X_sTQh.js";import{r as Q}from"../chunks/CDiOZD_h.js";import{b as I}from"../chunks/COIuQCY0.js";import{a as te}from"../chunks/D6zz_Kj-.js";import{s as Ie}from"../chunks/DrIL6A14.js";var Je=v('<span class="badge badge-info svelte-1xfmgl2" title="Full processing will occur when synced to a local instance">Awaiting Full Processing</span>'),Ke=v('<span class="badge badge-mode svelte-1xfmgl2"> </span>'),Qe=v('<span class="badge-group svelte-1xfmgl2"><span> </span> <!></span>');function Ve(W,C){const M={completed:{label:"Fully Processed",class:"badge-success"},needs_local:{label:"Pending Sync",class:"badge-warning"},pending:{label:"Pending",class:"badge-secondary"},processing:{label:"Processing...",class:"badge-primary"},failed:{label:"Failed",class:"badge-danger"}};let q=le(()=>M[C.processingStatus]??{label:C.processingStatus,class:"badge-secondary"}),T=le(()=>C.processingMode==="cloud_basic"?"Basic":C.processingMode==="local_full"?"Full":C.processingMode);var U=Qe(),m=s(U),k=s(m,!0);a(m);var H=r(m,2);{var E=g=>{var x=Je();d(g,x)},N=g=>{var x=Ke(),z=s(x,!0);a(x),P(()=>_(z,e(T))),d(g,x)};f(H,g=>{C.needsFullProcessing?g(E):g(N,!1)})}a(U),P(()=>{Ie(m,1,`badge ${e(q).class??""}`,"svelte-1xfmgl2"),_(k,e(q).label)}),d(W,U)}var We=v('<div class="alert alert-error"> </div>'),Ye=v('<div class="alert alert-success"> </div>'),Ze=v(`<div class="info-banner svelte-220hbx"><div class="info-icon svelte-220hbx"><svg viewBox="0 0 20 20" width="20" height="20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div> <div><strong>Cloud Mode</strong> &mdash; Basic text extraction is available for PDF, TXT, and
				MD files. Office documents (DOCX, PPTX, XLSX) and advanced OCR require local processing and
				will be queued for the next sync.</div></div>`),$e=v('<div class="stat-card svelte-220hbx"><span class="stat-value stat-danger svelte-220hbx"> </span> <span class="stat-label svelte-220hbx">Failed</span></div>'),ea=v('<div class="stats-row svelte-220hbx"><div class="stat-card svelte-220hbx"><span class="stat-value svelte-220hbx"> </span> <span class="stat-label svelte-220hbx">Total</span></div> <div class="stat-card svelte-220hbx"><span class="stat-value stat-success svelte-220hbx"> </span> <span class="stat-label svelte-220hbx">Completed</span></div> <div class="stat-card svelte-220hbx"><span class="stat-value stat-warning svelte-220hbx"> </span> <span class="stat-label svelte-220hbx">Awaiting Sync</span></div> <div class="stat-card svelte-220hbx"><span class="stat-value stat-pending svelte-220hbx"> </span> <span class="stat-label svelte-220hbx">Pending</span></div> <!></div>'),aa=v(`<p class="form-hint svelte-220hbx">Supported formats: <strong>PDF, TXT, MD</strong>. Other formats will be accepted and
					queued for full processing during the next local sync.</p>`),sa=v('<span class="btn-spinner svelte-220hbx"></span> Uploading...',1),ta=v('<div class="card form-card svelte-220hbx"><h2 class="svelte-220hbx">Upload Document</h2> <!> <form><div class="form-group svelte-220hbx"><label class="label" for="file">File *</label> <input id="file" type="file" class="input file-input svelte-220hbx" required accept=".pdf,.txt,.md,.docx,.doc,.pptx,.ppt,.xlsx,.xls,.html,.htm,.rtf,.odt,.odp,.ods"/></div> <div class="form-group svelte-220hbx"><label class="label" for="doc-title">Title</label> <input id="doc-title" class="input" placeholder="Auto-filled from filename"/></div> <div class="form-group svelte-220hbx"><label class="label" for="doc-description">Description</label> <textarea id="doc-description" class="textarea" placeholder="Brief description of the document"></textarea></div> <div class="form-row svelte-220hbx"><div class="form-group svelte-220hbx"><label class="label" for="doc-tags">Tags (comma-separated)</label> <input id="doc-tags" class="input" placeholder="flood, evacuation, elderly"/></div> <div class="form-group svelte-220hbx"><label class="label" for="doc-hazard">Hazard Type</label> <input id="doc-hazard" class="input" placeholder="flood, fire, storm"/></div></div> <div class="form-row svelte-220hbx"><div class="form-group svelte-220hbx"><label class="label" for="doc-location">Location</label> <input id="doc-location" class="input" placeholder="Riverside Street"/></div> <div class="form-group svelte-220hbx"><label class="label" for="doc-source">Source</label> <input id="doc-source" class="input" placeholder="Community workshop 2023"/></div></div> <div class="form-actions svelte-220hbx"><button type="button" class="btn btn-secondary">Cancel</button> <button type="submit" class="btn btn-primary"><!></button></div></form></div>'),la=v(`<p class="doc-sync-note svelte-220hbx">Full processing (OCR, structured extraction) will occur when this document is
							synced to a local instance.</p>`),ra=v('<div class="card doc-card svelte-220hbx"><div class="doc-header svelte-220hbx"><h3 class="svelte-220hbx"> </h3> <!></div> <p class="doc-message svelte-220hbx"> </p> <!> <div class="doc-actions svelte-220hbx"><button class="btn btn-secondary btn-sm svelte-220hbx">Refresh Status</button></div></div>'),oa=v('<h2 class="section-title svelte-220hbx">Uploaded Documents</h2> <div class="doc-list svelte-220hbx"></div>',1),ia=v('<div class="card empty-state svelte-220hbx"><p>No documents uploaded yet. Click "Upload Document" to get started.</p></div>'),na=v('<div class="container"><div class="page-header svelte-220hbx"><div class="header-row svelte-220hbx"><h1 class="svelte-220hbx">Documents</h1> <button class="btn btn-primary"> </button></div> <p class="svelte-220hbx">Upload and manage community knowledge documents.</p></div> <!> <!> <!> <!> <!> <!></div>');function ha(W,C){qe(C,!0);let M=p(""),q=p(""),T=p(!1),U=p(!1),m=p(null),k=p(""),H=p(""),E=p(""),N=p(""),g=p(""),x=p(""),z=p(Le([])),y=p(null),Y=p(!0);Re(async()=>{await re()});async function re(){o(Y,!0);try{o(y,await te.documents.getProcessingStats(),!0)}catch{}finally{o(Y,!1)}}function me(t){var i;const l=t.target;if((i=l.files)!=null&&i.length&&(o(m,l.files[0],!0),!e(k))){const u=e(m).name;o(k,u.substring(0,u.lastIndexOf("."))||u,!0)}}function Z(){o(m,null),o(k,""),o(H,""),o(E,""),o(N,""),o(g,""),o(x,""),o(T,!1),o(M,"")}async function ge(t){if(t.preventDefault(),!e(m)){o(M,"Please select a file.");return}o(U,!0),o(M,""),o(q,"");try{const l=await te.documents.upload(e(m),{title:e(k)||void 0,description:e(H)||void 0,tags:e(E)||void 0,location:e(N)||void 0,hazard_type:e(g)||void 0,source:e(x)||void 0});o(z,[l,...e(z)],!0),o(q,l.message,!0),Z(),await re()}catch(l){o(M,l instanceof Error?l.message:"Upload failed",!0)}finally{o(U,!1)}}async function he(t){try{const l=await te.documents.getStatus(t);o(z,e(z).map(i=>i.id===t?{...i,processing_status:l.processing_status,processing_mode:l.processing_mode,needs_full_processing:l.needs_full_processing}:i),!0)}catch{}}let oe=le(()=>{var t;return((t=e(y))==null?void 0:t.deployment_mode)==="cloud"});var $=na();Ge("220hbx",t=>{He(()=>{Ee.title="Documents - Community Resilience"})});var ee=s($),ie=s(ee),ae=r(s(ie),2);ae.__click=()=>{Z(),o(T,!e(T))};var xe=s(ae,!0);a(ae),a(ie),A(2),a(ee);var ne=r(ee,2);{var ye=t=>{var l=We(),i=s(l,!0);a(l),P(()=>_(i,e(M))),d(t,l)};f(ne,t=>{e(M)&&t(ye)})}var de=r(ne,2);{var we=t=>{var l=Ye(),i=s(l,!0);a(l),P(()=>_(i,e(q))),d(t,l)};f(de,t=>{e(q)&&t(we)})}var ce=r(de,2);{var De=t=>{var l=Ze();d(t,l)};f(ce,t=>{e(oe)&&t(De)})}var ve=r(ce,2);{var Fe=t=>{var l=ea(),i=s(l),u=s(i),c=s(u,!0);a(u),A(2),a(i);var b=r(i,2),O=s(b),w=s(O,!0);a(O),A(2),a(b);var X=r(b,2),B=s(X),R=s(B,!0);a(B),A(2),a(X);var D=r(X,2),F=s(D),j=s(F,!0);a(F),A(2),a(D);var L=r(D,2);{var G=h=>{var S=$e(),J=s(S),V=s(J,!0);a(J),A(2),a(S),P(()=>_(V,e(y).failed)),d(h,S)};f(L,h=>{e(y).failed>0&&h(G)})}a(l),P(()=>{_(c,e(y).total),_(w,e(y).completed),_(R,e(y).needs_local),_(j,e(y).pending)}),d(t,l)};f(ve,t=>{e(y)&&!e(Y)&&t(Fe)})}var ue=r(ve,2);{var Se=t=>{var l=ta(),i=r(s(l),2);{var u=n=>{var K=aa();d(n,K)};f(i,n=>{e(oe)&&n(u)})}var c=r(i,2),b=s(c),O=r(s(b),2);O.__change=me,a(b);var w=r(b,2),X=r(s(w),2);Q(X),a(w);var B=r(w,2),R=r(s(B),2);Ne(R),a(B);var D=r(B,2),F=s(D),j=r(s(F),2);Q(j),a(F);var L=r(F,2),G=r(s(L),2);Q(G),a(L),a(D);var h=r(D,2),S=s(h),J=r(s(S),2);Q(J),a(S);var V=r(S,2),pe=r(s(V),2);Q(pe),a(V),a(h);var be=r(h,2),fe=s(be);fe.__click=Z;var se=r(fe,2),Te=s(se);{var Ue=n=>{var K=sa();A(),d(n,K)},ke=n=>{var K=Be("Upload");d(n,K)};f(Te,n=>{e(U)?n(Ue):n(ke,!1)})}a(se),a(be),a(c),a(l),P(()=>se.disabled=e(U)||!e(m)),Oe("submit",c,ge),I(X,()=>e(k),n=>o(k,n)),I(R,()=>e(H),n=>o(H,n)),I(j,()=>e(E),n=>o(E,n)),I(G,()=>e(g),n=>o(g,n)),I(J,()=>e(N),n=>o(N,n)),I(pe,()=>e(x),n=>o(x,n)),d(t,l)};f(ue,t=>{e(T)&&t(Se)})}var Pe=r(ue,2);{var Ce=t=>{var l=oa(),i=r(_e(l),2);je(i,21,()=>e(z),u=>u.id,(u,c)=>{var b=ra(),O=s(b),w=s(O),X=s(w,!0);a(w);var B=r(w,2);Ve(B,{get processingStatus(){return e(c).processing_status},get processingMode(){return e(c).processing_mode},get needsFullProcessing(){return e(c).needs_full_processing}}),a(O);var R=r(O,2),D=s(R,!0);a(R);var F=r(R,2);{var j=h=>{var S=la();d(h,S)};f(F,h=>{e(c).needs_full_processing&&h(j)})}var L=r(F,2),G=s(L);G.__click=()=>he(e(c).id),a(L),a(b),P(()=>{_(X,e(c).title),_(D,e(c).message)}),d(u,b)}),a(i),d(t,l)},Me=t=>{var l=Xe(),i=_e(l);{var u=c=>{var b=ia();d(c,b)};f(i,c=>{e(T)||c(u)},!0)}d(t,l)};f(Pe,t=>{e(z).length>0?t(Ce):t(Me,!1)})}a($),P(()=>_(xe,e(T)?"Cancel":"Upload Document")),d(W,$),Ae()}ze(["click","change"]);export{ha as component};
